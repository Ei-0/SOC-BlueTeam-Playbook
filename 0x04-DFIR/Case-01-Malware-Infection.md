# Case 01 â€“ Malware Infection

## ğŸ“Œ Incident Summary
A malware infection was detected on a corporate workstation following suspicious process execution and abnormal network behavior.

The detection originated from endpoint security telemetry indicating malicious activity consistent with post-exploitation techniques.

The incident required immediate containment to prevent potential lateral movement and further compromise.

---

## ğŸ•µï¸ Detection Source
- EDR Alert (Suspicious Process Behavior)
- SIEM Correlated Alert
- Windows Security Logs

---

## ğŸ–¥ï¸ Affected Asset
- Asset Type: User Workstation
- Operating System: Windows 10
- User Context: Standard Domain User

---

## â° Incident Timeline (High-Level)
- Suspicious process execution detected
- Outbound connection to suspicious domain observed
- Endpoint isolated by SOC
- DFIR investigation initiated

---

## âš ï¸ Severity
**Medium â†’ High**

---

## ğŸ¯ Initial Impact Assessment
- Single endpoint compromised
- No immediate evidence of lateral movement
- Potential credential exposure
- Risk of persistence mechanisms

# Logs Analysis

## ğŸ” Windows Security Logs
The following events were identified during analysis:

- Event ID 4688 â€“ Suspicious process creation
- Parent-child process anomaly observed
- Execution from non-standard directory

---

## ğŸ§  Process Analysis
- Suspicious executable launched via PowerShell
- Command-line arguments indicate potential payload execution
- Process behavior inconsistent with user role

---

## ğŸŒ Network Activity
- Outbound connection to unknown external domain
- Communication over non-standard port
- Traffic pattern consistent with command-and-control (C2) activity

---

## ğŸ§© Correlation Findings
Correlating endpoint, process, and network logs confirms malicious activity rather than user error or misconfiguration.

# Forensic Timeline

| Time | Event |
|-----|------|
| 09:14 | PowerShell process executed |
| 09:15 | Suspicious executable launched |
| 09:16 | Outbound connection initiated |
| 09:18 | EDR alert triggered |
| 09:20 | Endpoint isolated |

# MITRE ATT&CK Mapping â€“ Case 01 Malware Infection

## ğŸ¯ Overview
This section maps the observed attacker behaviors during the malware infection to the MITRE ATT&CK framework.

Mapping the incident to ATT&CK helps understand the attack progression, identify detection gaps, and improve defensive coverage.

---

## ğŸ§­ Attack Flow Summary
The attacker leveraged built-in system tools to execute malicious code, establish external communication, and potentially prepare for further actions such as persistence or lateral movement.

---

## ğŸ§© MITRE ATT&CK Technique Mapping

| Tactic | Technique | Technique ID | Observed Evidence |
|------|----------|-------------|------------------|
| Initial Access | Phishing | T1566 | Malware likely delivered via phishing-related activity |
| Execution | PowerShell | T1059.001 | Suspicious PowerShell execution observed |
| Execution | Command and Scripting Interpreter | T1059 | Payload execution via scripting |
| Defense Evasion | Obfuscated Files or Information | T1027 | Encoded or suspicious command-line arguments |
| Command and Control | Application Layer Protocol | T1071 | Outbound connection to external domain |
| Command and Control | Web Protocols | T1071.001 | HTTP/S-based C2 communication |

---

## ğŸ” Analyst Notes
- The attacker relied on **living-off-the-land techniques**, avoiding the use of custom malware initially.
- PowerShell abuse played a key role in execution and evasion.
- Early detection by EDR prevented further progression into persistence or lateral movement phases.

---

## ğŸ“ˆ Detection & Coverage Gaps
- Enhanced PowerShell logging proved effective.
- Network-based C2 detection can be further improved.
- Additional detections for persistence techniques should be considered.

---

## ğŸ› ï¸ Defensive Improvements
- Expand PowerShell abuse detection rules
- Improve phishing email filtering
- Implement tighter outbound traffic monitoring
- Enhance user behavior analytics (UBA)

---

## âœ… Conclusion
MITRE ATT&CK mapping provides structured insight into attacker behavior and ensures that detection and response strategies remain aligned with real-world attack techniques.


# Final DFIR Report â€“ Case 01

## ğŸ§  Root Cause
The infection was caused by execution of a malicious payload delivered through a suspicious PowerShell command, likely originating from a phishing-related vector.

---

## ğŸ›‘ Containment Actions
- Endpoint isolated from network
- Malicious process terminated
- User credentials reset as precaution

---

## ğŸ§¹ Eradication
- Malicious files removed
- Persistence mechanisms eliminated
- System scanned and cleaned

---

## ğŸ”„ Recovery
- System restored to operational state
- Monitoring increased for affected user
- Endpoint returned to network after validation

---

## ğŸ“š Lessons Learned
- Enhanced PowerShell logging is critical
- User awareness training should be reinforced
- Detection rules updated for similar behavior
